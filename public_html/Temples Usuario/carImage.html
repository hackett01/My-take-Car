<!DOCTYPE html>
<!--
<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> 
<html lang=""> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <link rel="stylesheet" href="../css/bootstrap.min.css">
        <link rel="stylesheet" href="../font-awesome-4.5.0/css/font-awesome.min.css">
        <link href='https://fonts.googleapis.com/css?family=Didact+Gothic' rel='stylesheet' type='text/css'>  
        <script type="text/javascript" src="../Javascript enhancements/js/jquery-1.9.1.min.js"></script>
        <script type="text/javascript" src="../Temples Usuario/script.js"></script>
        <link rel="stylesheet" type="text/css"  href="../Temples Usuario/styles.css">
        <link rel="stylesheet" type="text/css"  href="../Temples Usuario/styles.css">
        <link rel="stylesheet" type="text/css"  href="../Temples Usuario/responsive-css-tabs/css/noti-css.css">
        <link href="../startbootstrap-simple-sidebar-1.0.5/css/simple-sidebar.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css"  href="../Javascript enhancements/css/smart-forms.css">
        <script type="text/javascript" src="../Javascript enhancements/js/jquery.validate.min.js"></script>
        <script type="text/javascript" src="../Javascript enhancements/js/additional-methods.min.js"></script>
        <link rel="stylesheet" type="text/css"  href="../Temples Usuario/css-user/styles.css">
        <link rel="stylesheet" href="../Temples Usuario/css-user/car.css"/>
        <script type="text/javascript" src="http://www.parsecdn.com/js/parse-latest.js"></script>

        <script type="text/javascript">

            $(function () {

                $(".errorsContainer").hide();

                $("#contactform").validate({
                    errorClass: "state-error",
                    validClass: "state-success",
                    errorElement: "li",
                    rules: {
                        firstaddr: {
                            required: true
                        },
                        lastaddr: {
                            required: true
                        },
                        location: {
                            required: true
                        },
                        typecar: {
                            required: true
                        },
                        zip: {
                            required: true
                        },
                        city: {
                            required: true
                        },
                        states: {
                            required: true
                        }




                    },
                    messages: {
                        firstaddr: {
                            required: 'Enter your firstaddr'
                        },
                        lastaddr: {
                            required: 'Enter year of the car'
                        },
                        location: {
                            required: 'Please choose location'
                        },
                        zip: {
                            required: 'Please you zip'
                        },
                        city: {
                            required: 'Plece you city '
                        },
                        states: {
                            required: 'Plece you states '
                        }

                    },
                    invalidHandler: function (form, validator) {
                        $(".errorsContainer").show();
                    },
                    highlight: function (element, errorClass, validClass) {
                        $(element).closest('.field').addClass(errorClass).removeClass(validClass);
                        if (this.numberOfInvalids() > 0) {
                            $(".errorsContainer").show();
                        }
                    },
                    unhighlight: function (element, errorClass, validClass) {
                        $(element).closest('.field').removeClass(errorClass).addClass(validClass);
                        if (this.numberOfInvalids() == 0) {
                            $(".errorsContainer").hide();
                        }
                    },
                    errorPlacement: function (error, element) {
                        error.appendTo("#smartErrors");
                    }
                });

            });

        </script>



    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="http://localhost:8383/My-take-Car/index.html">Take my car</a>
                </div>

                <div id="navbar" class="navbar-collapse collapse">
                    <form class="navbar-form navbar-left" method="GET" role="search">
                        <div class="form-group">
                            <input type="text" name="q" class="form-control" placeholder="Search">
                        </div>
                        <button type="submit" class="btn btn-default"><i class="glyphicon glyphicon-search"></i></button>
                    </form>




                    <ul class="nav navbar-nav navbar-right">
                        <li><a id="cuenta" href="#"></a></li>
                        <li class="dropdown" id="listaOption">
                            <a href="#" class="dropdown-toggle " data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">

                                <span class="fa fa-bars" id="cog"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="index-user.html">Perfil</a></li>
                                <li><a href="Notificaciones_1.html">Cuenta</a></li>
                                <li><a href="ListoFads.html">Tus anuncios</a></li>
                                <li>
                                    <a id="logout" href="#"  >Salir</a>
                                </li>

                            </ul>
                        </li>
                    </ul>
                </div><!--/.nav-collapse -->
            </div><!--/.container-fluid -->
        </nav>


        <div id="wrapper">

            <!-- Sidebar -->
            <div id="sidebar-wrapper">
                <ul class="sidebar-nav">
                    <li><a href='carEssentials.html'>Datos Básicos</a></li>
                    <li><a href='describeAdd.html'>Descripción</a></li>
                    <li><a href='customerLocation.html'>Ubicación</a></li>
                    <li><a href='carImage.html'>Fotos</a></li>
                    <li><a href='autoServices.html'>Servicios </a></li>
                    <li><a href='vehicleServices.html'>Seguridad</a></li>
                    <li><a href='insurance-policy.html'>Poliza</a></li>
                    <li><a href='pricesRent.html'>Precios</a></li>
                    <li><a href='reservasCar.html'>Reserva</a></li>
                    <li><a href='calendarReser.html'>Calendario</a></li>
                </ul>
            </div>
            <!-- /#sidebar-wrapper -->

            <!-- Page Content -->
            <div id="page-content-wrapper">
                <div class="container-fluid">
                    <a href="#menu-toggle" class="btn btn-default" id="menu-toggle"><span class=" fa fa-bars "></span></a>

                    <div class="row">
                        <div class="col-lg-12">


                            <div class="frm-row" id="paymentform">
                                <div class="smart-wrap">
                                    <div class="smart-forms smart-container wrap-0">

                                        <div class="form-header header-red">
                                            <h3>
                                                Las fotos dan vida a tu automóvil

                                            </h3>
                                        </div><!-- end .form-header section -->

                                        <p id="text-paymenr">
                                            Incluye fotos de las zonas a las que tendrán acceso los huéspedes. Podrás añadir más en otro momento, si quieres.
                                        </p>

                                        <form id="photo-user">
                                            <div class="smart-forms smart-container ">
                                                <div class="section">
                                                    <label for="file1" class="field file">
                                                        <span class="button btn-primary">Elige tu foto</span>
                                                        <input type="file" class="gui-file" name="profilePhotoFileUpload" id="profilePhotoFileUpload" onChange="document.getElementById('uploader1').value = this.value;">
                                                        <input type="text" class="gui-input" id="uploader1" placeholder="no file selected" readonly>
                                                    </label>
                                                </div><!-- end  section -->

                                            </div><!-- end .smart-forms section -->

                                        </form>

                                        <div class="ih-item circle colored effect13 top_to_bottom">
                                            <a href="#">
                                                <div class="img"  >
                                                    <img id="profileImg"  width="100" ></div>
                                                <div class="info">
                                                    <div class="info-back">
                                                        <h3>Truman Capote </h3>
                                                    </div>
                                                </div>
                                            </a>
                                        </div>




                                    </div><!-- end .smart-forms section -->
                                </div><!-- end .smart-wrap section -->              

                            </div>



                        </div>
                    </div>
                </div>
            </div>
            <!-- /#page-content-wrapper -->

        </div>

        <script>
            $("#menu-toggle").click(function (e) {
                e.preventDefault();
                $("#wrapper").toggleClass("toggled");
            });

        </script>

        <script type="text/javascript">

            Parse.initialize("AwaxZPecidC77J5pymOrQVxB3cXkhJSKdmipzt7T", "vwz5gTGne4HvdawlNUgGuhiC79FWi7kYGgyjsIPo");


            var paramstr = window.location.search.substr(1);
            var paramarr = paramstr.split("&");
            var params = {};

            var currentUser = Parse.User.current();
            var test = JSON.stringify(currentUser);
            var jsontext = test;
            var contact = JSON.parse(jsontext);

            var Username = contact.username;
            var output = "";
            output += "Bienvenido :  " + Username;
            $("#cuenta").html(output);

            $('#logout').click(function (event) {
                event.preventDefault();
                Parse.User.logOut();
                console.log("salir");
                window.location.href = "http://localhost:8383/My-take-Car/index.html";
            });


            for (var i = 0; i < paramarr.length; i++) {
                var tmparr = paramarr[i].split("=");
                params[tmparr[0]] = tmparr[1];
            }
            var Add = tmparr[1];

            function saveJobApp(objParseFile)
            {
                var Add = tmparr[1];
                var Post = Parse.Object.extend("addUser");
                var myPost = new Post();
                var post = new Post();
                post.id = Add;
                var user = Parse.User.current();
                var jobApplication = new Parse.Object("photosCar");
                jobApplication.set("user", user);
                jobApplication.set("title", "profile");
                jobApplication.set("parent", post);
                jobApplication.set("profileImg", objParseFile);
                jobApplication.save(null,
                        {
                            success: function (gameScore) {
                                // Execute any logic that should take place after the object is saved.

                                window.location = "autoServices.html?num=" + Add;
                                var photo = gameScore.get("profileImg");
                                $("#profileImg")[0].src = photo.url();


                            },
                            error: function (gameScore, error) {
                                // Execute any logic that should take place if the save fails.
                                // error is a Parse.Error with an error code and description.
                                //   alert('Failed to create new object, with error code: ' + error.description);
                            }
                        });
            }

            $('#profilePhotoFileUpload').bind("change", function (e) {
                var fileUploadControl = $("#profilePhotoFileUpload")[0];
                var file = fileUploadControl.files[0];
                var name = file.name; //This does *NOT* need to be a unique name
                var parseFile = new Parse.File(name, file);

                parseFile.save().then
                        (
                                function ()
                                {
                                    saveJobApp(parseFile);
                                    $("#profilePhotoFileUpload").val("");
                                },
                                function (error)
                                {
                                    //  alert("error");
                                }
                        );
            });



            var GameScore = Parse.Object.extend("photosCar");
            var query = new Parse.Query(GameScore);
            query.equalTo("title", "profile");
            query.find({
                success: function (results) {
                    //   alert("Successfully retrieved " + results.length + " scores.");
                    // Do something with the returned Parse.Object values
                    for (var i = 0; i < results.length; i++) {
                        var object = results[i];

                        var photo = object.get('profileImg');
                        $("#profileImg")[0].src = photo.url();
                        console.log(photo);
                    }
                },
                error: function (error) {
                    //   alert("Error: " + error.code + " " + error.message);
                }
            });

        </script>

        <script src="../js/vendor/bootstrap.min.js"></script>
        <script src="../js/vendor/responces.js"></script>

    </body>
</html>
